# Military Holidays TV Calendar

Android TV приложение для отображения календаря военных праздников России с автоматической сменой фоновых изображений.

## Описание

Приложение предназначено для Android TV устройств и отображает полноэкранный интерфейс с:
- Фоновым изображением, меняющимся в зависимости от военных праздников
- Текущей датой в формате dd.MM.yyyy (левый верхний угол)
- Текущим временем в формате HH:mm:ss (правый верхний угол)
- Часовым поясом Europe/Moscow

## Основные возможности

- ✅ Автоматическая смена фоновых изображений по военным праздникам
- ✅ Отображение даты и времени в реальном времени (обновление каждую секунду)
- ✅ Автозапуск при включении телевизора
- ✅ Настройки автозапуска через системные разрешения
- ✅ Поддержка Android TV / Leanback
- ✅ Оптимизация для устройств с 1 GB RAM
- ✅ Полностью автономная работа (без интернета)

## Технические требования

- **minSdk:** 23 (Android 6.0)
- **targetSdk:** 34 (Android 14)
- **compileSdk:** 35
- **Язык:** Kotlin
- **UI Framework:** Jetpack Compose (TV Material3)
- **Архитектура:** Универсальный APK (все архитектуры)

## Структура проекта

```
app/
├── src/main/
│   ├── assets/
│   │   ├── holidays/          # Изображения военных праздников
│   │   │   ├── holidays.json  # JSON с датами и именами файлов
│   │   │   └── *.png          # Изображения праздников
│   │   └── images/
│   │       └── russia_flag.png  # Флаг по умолчанию
│   ├── java/com/example/military_holidays_tv_calendar/
│   │   ├── MainActivity.kt     # Главная активность
│   │   ├── data/
│   │   │   └── AppPreferences.kt  # Хранение настроек (DataStore)
│   │   ├── repository/
│   │   │   └── HolidayRepository.kt  # Загрузка праздников из JSON
│   │   ├── receiver/
│   │   │   └── BootReceiver.kt  # Автозапуск при загрузке системы
│   │   ├── ui/
│   │   │   ├── FirstLaunchDialog.kt  # Диалог первого запуска
│   │   │   ├── SettingsDialog.kt     # Диалог настроек
│   │   │   └── UiState.kt            # Состояние UI
│   │   └── utils/
│   │       ├── AutostartPermissionHelper.kt  # Запрос разрешений
│   │       └── TvUtils.kt                    # Утилиты для Android TV
│   └── AndroidManifest.xml
└── build.gradle.kts
```

## Установка и запуск

### Требования для разработки

- Android Studio Hedgehog или новее
- JDK 11 или выше
- Android SDK с API 35

### Сборка проекта

```bash
# Клонирование репозитория
git clone <repository-url>
cd military-holidays-tv-calendar

# Сборка release APK
./gradlew assembleRelease

# APK будет создан в:
# app/build/outputs/apk/release/app-release.apk
```

### Установка на устройство

1. Скопируйте `app-release.apk` на Android TV устройство
2. Разрешите установку из неизвестных источников в настройках
3. Установите APK через файловый менеджер

## Настройка автозапуска

### Первый запуск

При первом запуске на Android TV устройстве появится диалог:
- **"Включить автозапуск при включении телевизора?"**
- При выборе **"Да"** откроется экран системных настроек для разрешения показа поверх других окон
- Включите переключатель для приложения в настройках "Allow display over other apps"

### Ручная настройка

1. Откройте настройки приложения (долгое нажатие OK/Enter или тап 3 секунды)
2. Включите чекбокс "Автозапуск при включении телевизора"
3. Нажмите "Сохранить"
4. В открывшихся системных настройках включите разрешение на показ поверх других окон

### Важно

- Автозапуск требует разрешения **"Показ поверх других окон"** (SYSTEM_ALERT_WINDOW)
- На некоторых устройствах может потребоваться дополнительная настройка в системных настройках телевизора
- Автозапуск работает только на Android TV устройствах

## Редактирование праздников

### Добавление нового праздника

1. Добавьте изображение в `app/src/main/assets/holidays/`
2. Отредактируйте `app/src/main/assets/holidays/holidays.json`:

```json
{
  "MM-DD": "имя_файла.png"
}
```

Пример:
```json
{
  "01-21": "engineer_troops_day.png",
  "05-09": "victory_day.png"
}
```

### Формат даты

- **MM** - месяц (01-12)
- **DD** - день (01-31)
- Формат: `"MM-DD": "файл.png"`

### Замена изображений

1. Замените файлы в `app/src/main/assets/holidays/` или `app/src/main/assets/images/`
2. Сохраните файлы с теми же именами
3. Пересоберите APK: `./gradlew assembleRelease`

## Список военных праздников

Приложение включает следующие военные праздники (полный список в `holidays.json`):

- **Январь:** День инженерных войск, День штурмана ВМФ, День освобождения Ленинграда
- **Февраль:** День разгрома в Сталинградской битве, День защитника Отечества
- **Март:** День моряка-подводника, День войск национальной гвардии
- **Апрель:** День космонавтики, День войск ПВО, Ледовое побоище
- **Май:** День Победы, День создания ВС РФ, День флотов
- **Июнь:** День памяти и скорби, День ВМФ России
- **Июль:** День ветеранов боевых действий, Чесменское сражение
- **Август:** День ВДВ, День ВВС, Курская битва
- **Сентябрь:** День российской гвардии, Бородинское сражение
- **Октябрь:** День Сухопутных войск, День Космических войск
- **Ноябрь:** День народного единства, День военного разведчика
- **Декабрь:** День Неизвестного Солдата, Синопское сражение

## Логирование

Приложение использует логирование для отладки:

- **MainActivity** - основные события приложения
- **FirstLaunchDialog** - события диалога первого запуска
- **SettingsDialog** - события диалога настроек
- **BootReceiver** - события автозапуска

Просмотр логов:
```bash
adb logcat -s MainActivity FirstLaunchDialog SettingsDialog BootReceiver
```

## Разрешения

Приложение запрашивает следующие разрешения:

- `RECEIVE_BOOT_COMPLETED` - для автозапуска при загрузке системы
- `SYSTEM_ALERT_WINDOW` - для показа поверх других окон (критично для автозапуска)
- `REQUEST_IGNORE_BATTERY_OPTIMIZATIONS` - для предотвращения оптимизации батареи

## Версии

### 1.0.0 (текущая)
- Первый релиз
- Поддержка военных праздников
- Автозапуск при включении телевизора
- Настройки автозапуска
- Запрос системных разрешений

## Разработка

### Зависимости

- Jetpack Compose (TV Material3)
- DataStore Preferences
- Kotlin Coroutines
- Java Time (desugaring для старых версий Android)

### Архитектура

- **MVVM-подобная** структура с Compose
- **Repository pattern** для работы с данными
- **DataStore** для хранения настроек
- **BroadcastReceiver** для автозапуска

## Лицензия

Этот проект создан для образовательных целей.

## Контакты

Для вопросов и предложений создайте issue в репозитории.

